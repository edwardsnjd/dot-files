# To use this prompt, add the following to your bash config file.
#
#     source ~/.bash_prompt
#
# Your bash config file is ~/.bash_profile.

# Colour attribute codes

RESET="\[$(tput sgr0)\]"
RED="\[$(tput setaf 1)\]"
GREEN="\[$(tput setaf 2)\]"
PURPLE="\[$(tput setaf 5)\]"
LOLIGHT="\[$(tput bold; tput setaf 0)\]"
PREFIX="${PURPLE}Â»${RESET}"

# Functions

function PromptPS1() {
  local exit="$(PromptExitInfo)"
  PS1="${PREFIX} $(PromptTime)\W $(PromptGitInfo)${exit}\$ "
}

function PromptGitInfo() {
  local branch="$(GitCurrentBranch)"
  [[ -n "$branch" ]] && printf "${GREEN}(${branch})${RESET} "
}

function PromptExitInfo() {
  local exitCode="$?"
  [[ $SECONDS -le 1 ]] && exit # HACK: Exit code is 1 when shell starts
  [[ $exitCode != 0 ]] && printf "${RED}${exitCode}${RESET} "
}

function PromptTime() {
  printf "${LOLIGHT}$(date +%H:%M)${RESET} "
}

function GitCurrentBranch() {
  git branch 2>/dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\1/'
}

# Prompt

export PROMPT_COMMAND="PromptPS1"
