#!/usr/bin/env bash

# Usage: tmux-attach
#
# Fuzzy select an available tmux session then attach or
# switch to selected session.

set -o nounset
set -o errexit

Main() {
  local session=$(ChooseSession)

  if [[ -z "${session}" ]]
  then
    echo "(No session selected)"
  else
    [[ -z "${TMUX:-}" ]] \
      && tmux attach-session -t "${session}" \
      || tmux switch-client -t "${session}"
  fi
}

ChooseSession() {
 tmux ls -F "#{session_id}	#S" \
   | fzf --nth=2 \
   | cut -f2
 }

Main
