#!/usr/bin/env bash

# Interactive FZF browser of all interesting files to git

function Main() {
  # See man terminfo for colors
  local DELETED="$(tput setaf 1)"
  local RESET="$(tput sgr0)"

  git ls-files \
    --other \
    --deleted \
    --modified \
    --exclude-standard \
    --dedup \
    | sort \
    | while read file; do
          if [[ -e "$file" ]]; then
            echo "$file"
          else
            echo -e "${DELETED}${file}${RESET}"
          fi
        done \
    | fzf \
      --header ":: Files interesting to git" \
      --reverse \
      --multi \
      --height "40%" \
    | xargs echo
}

Main "$@"
